<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run differential expression analysis with limma — do_limma • HDAnalyzeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run differential expression analysis with limma — do_limma"><meta name="description" content="do_limma() performs differential expression analysis using limma package.
It can correct the results for metadata columns like Sex, Age, or BMI.
The output tibble includes the logFC, p-values, as well as the FDR adjusted p-values.
The function removes the NAs from the columns that are used to correct for.
It can generate and save volcano plots."><meta property="og:description" content="do_limma() performs differential expression analysis using limma package.
It can correct the results for metadata columns like Sex, Age, or BMI.
The output tibble includes the logFC, p-values, as well as the FDR adjusted p-values.
The function removes the NAs from the columns that are used to correct for.
It can generate and save volcano plots."><meta property="og:image" content="https://hda1472.github.io/DA_RPackage/logo.png"></head><body><p>









  pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HDAnalyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/HDAnalyzeR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data_preprocessing.html">Data Preprocessing &amp; Quality Control Check</a></li>
    <li><a class="dropdown-item" href="../articles/data_imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/differential_expression.html">Differential Expression Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Classification Models</a></li>
    <li><a class="dropdown-item" href="../articles/post_analysis.html">Post Analysis: Pathway Enrichment &amp; Automated Literature Search</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/HDA1472/DA_RPackage/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Run differential expression analysis with limma</h1>
      <small class="dont-index">Source: <a href="https://github.com/HDA1472/DA_RPackage/blob/main/R/diff_expression.R" class="external-link"><code>R/diff_expression.R</code></a></small>
      <div class="d-none name"><code>do_limma.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>do_limma()</code> performs differential expression analysis using limma package.
It can correct the results for metadata columns like Sex, Age, or BMI.
The output tibble includes the logFC, p-values, as well as the FDR adjusted p-values.
The function removes the NAs from the columns that are used to correct for.
It can generate and save volcano plots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">do_limma</span><span class="op">(</span></span>
<span>  <span class="va">olink_data</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>  <span class="va">case</span>,</span>
<span>  <span class="va">control</span>,</span>
<span>  correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span><span class="op">)</span>,</span>
<span>  correct_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor"</span>, <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>  wide <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  only_female <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  only_male <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  volcano <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pval_lim <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  logfc_lim <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  top_up_prot <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  top_down_prot <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"diff_exp"</span>,</span>
<span>  report_nproteins <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-olink-data">olink_data<a class="anchor" aria-label="anchor" href="#arg-olink-data"></a></dt>
<dd><p>A tibble with the Olink data in wide format.</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>A tibble with the metadata.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>The variable of interest that includes the case and control groups.</p></dd>


<dt id="arg-case">case<a class="anchor" aria-label="anchor" href="#arg-case"></a></dt>
<dd><p>The case group.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>The control groups.</p></dd>


<dt id="arg-correct">correct<a class="anchor" aria-label="anchor" href="#arg-correct"></a></dt>
<dd><p>The variables to correct the results with. Default c("Sex", "Age").</p></dd>


<dt id="arg-correct-type">correct_type<a class="anchor" aria-label="anchor" href="#arg-correct-type"></a></dt>
<dd><p>The type of the variables to correct the results with. Default c("factor", "numeric", "numeric").</p></dd>


<dt id="arg-wide">wide<a class="anchor" aria-label="anchor" href="#arg-wide"></a></dt>
<dd><p>If the data is in wide format. Default is TRUE.</p></dd>


<dt id="arg-only-female">only_female<a class="anchor" aria-label="anchor" href="#arg-only-female"></a></dt>
<dd><p>The female specific diseases. Default is NULL.</p></dd>


<dt id="arg-only-male">only_male<a class="anchor" aria-label="anchor" href="#arg-only-male"></a></dt>
<dd><p>The male specific diseases. Default is NULL.</p></dd>


<dt id="arg-volcano">volcano<a class="anchor" aria-label="anchor" href="#arg-volcano"></a></dt>
<dd><p>Generate volcano plots. Default is TRUE.</p></dd>


<dt id="arg-pval-lim">pval_lim<a class="anchor" aria-label="anchor" href="#arg-pval-lim"></a></dt>
<dd><p>The p-value limit of significance. Default is 0.05.</p></dd>


<dt id="arg-logfc-lim">logfc_lim<a class="anchor" aria-label="anchor" href="#arg-logfc-lim"></a></dt>
<dd><p>The logFC limit of significance. Default is 0.</p></dd>


<dt id="arg-top-up-prot">top_up_prot<a class="anchor" aria-label="anchor" href="#arg-top-up-prot"></a></dt>
<dd><p>The number of top up regulated proteins to label on the plot. Default is 40.</p></dd>


<dt id="arg-top-down-prot">top_down_prot<a class="anchor" aria-label="anchor" href="#arg-top-down-prot"></a></dt>
<dd><p>The number of top down regulated proteins to label on the plot. Default is 10.</p></dd>


<dt id="arg-palette">palette<a class="anchor" aria-label="anchor" href="#arg-palette"></a></dt>
<dd><p>The color palette for the plot. If it is a character, it should be one of the palettes from <code><a href="get_hpa_palettes.html">get_hpa_palettes()</a></code>. Default is "diff_exp".</p></dd>


<dt id="arg-report-nproteins">report_nproteins<a class="anchor" aria-label="anchor" href="#arg-report-nproteins"></a></dt>
<dd><p>If the number of significant proteins should be reported in the subtitle. Default is TRUE.</p></dd>


<dt id="arg-subtitle">subtitle<a class="anchor" aria-label="anchor" href="#arg-subtitle"></a></dt>
<dd><p>The subtitle of the plot or NULL for no subtitle.</p></dd>


<dt id="arg-save">save<a class="anchor" aria-label="anchor" href="#arg-save"></a></dt>
<dd><p>Save the volcano plots. Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the differential expression results and volcano plots.</p><ul><li><p>de_results: A list with the differential expression results.</p></li>
<li><p>volcano_plots: A list with the volcano plots.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For sex-specific diseases, there will be no correction for Sex.
This is performed automatically by the function. It will also filter out
rows with NA values in any of the columns that are used for correction,
either the <code>variable</code> or in <code>correct</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">de_results</span> <span class="op">&lt;-</span> <span class="fu">do_limma</span><span class="op">(</span><span class="va">example_data</span>,</span></span>
<span class="r-in"><span>                       <span class="va">example_metadata</span>,</span></span>
<span class="r-in"><span>                       case <span class="op">=</span> <span class="st">"AML"</span>,</span></span>
<span class="r-in"><span>                       control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CLL"</span>, <span class="st">"MYEL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       wide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Comparing AML with CLL, MYEL.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>450 rows were removed because they contain NAs in Disease or Sex, Age!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Results for AML</span></span></span>
<span class="r-in"><span><span class="va">de_results</span><span class="op">$</span><span class="va">de_results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 100 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Assay     logFC   CI.L   CI.R AveExpr     t  P.Value adj.P.Val      B Disease</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ADA       1.33   0.966  1.70    1.46   7.16 4.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>   4.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-9</span> 14.7   AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AZU1      1.77   1.24   2.31    0.592  6.58 8.73<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span>   4.37<span style="color: #949494;">e</span><span style="color: #BB0000;">-8</span> 11.8   AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ANGPT1   -<span style="color: #BB0000;">1.75</span>  -<span style="color: #BB0000;">2.35</span>  -<span style="color: #BB0000;">1.15</span>    1.26  -<span style="color: #BB0000;">5.79</span> 4.87<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span>   1.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>  7.95  AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ACP6     -<span style="color: #BB0000;">0.786</span> -<span style="color: #BB0000;">1.11</span>  -<span style="color: #BB0000;">0.459</span>   1.36  -<span style="color: #BB0000;">4.75</span> 5.22<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>   1.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  3.43  AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ARHGEF12 -<span style="color: #BB0000;">1.30</span>  -<span style="color: #BB0000;">1.90</span>  -<span style="color: #BB0000;">0.709</span>   3.38  -<span style="color: #BB0000;">4.34</span> 2.82<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>   5.64<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  1.83  AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> APP      -<span style="color: #BB0000;">0.852</span> -<span style="color: #BB0000;">1.26</span>  -<span style="color: #BB0000;">0.443</span>   0.959 -<span style="color: #BB0000;">4.13</span> 6.46<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>   1.08<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>  1.03  AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ACAN     -<span style="color: #BB0000;">0.630</span> -<span style="color: #BB0000;">0.938</span> -<span style="color: #BB0000;">0.322</span>   0.596 -<span style="color: #BB0000;">4.05</span> 8.66<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>   1.24<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>  0.737 AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ATOX1    -<span style="color: #BB0000;">0.933</span> -<span style="color: #BB0000;">1.40</span>  -<span style="color: #BB0000;">0.467</span>   3.23  -<span style="color: #BB0000;">3.96</span> 1.21<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>   1.51<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>  0.445 AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AGR2     -<span style="color: #BB0000;">1.19</span>  -<span style="color: #BB0000;">1.83</span>  -<span style="color: #BB0000;">0.545</span>   1.78  -<span style="color: #BB0000;">3.66</span> 3.70<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>   4.11<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> -<span style="color: #BB0000;">0.618</span> AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ANXA11   -<span style="color: #BB0000;">0.692</span> -<span style="color: #BB0000;">1.08</span>  -<span style="color: #BB0000;">0.304</span>   0.973 -<span style="color: #BB0000;">3.53</span> 5.78<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>   5.78<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> -<span style="color: #BB0000;">1.02</span>  AML    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 90 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: sig &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Volcano plot for AML</span></span></span>
<span class="r-in"><span><span class="va">de_results</span><span class="op">$</span><span class="va">volcano_plot</span></span></span>
<span class="r-plt img"><img src="do_limma-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer></div>





  
</body></html>

