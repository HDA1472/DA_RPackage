<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Normalize data and remove batch effects — normalize_data • HDAnalyzeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Normalize data and remove batch effects — normalize_data"><meta name="description" content="normalize_data() normalizes the data by scaling them and removing their batch effects.
It first converts the data to wide format if they are not already. It then removes
the batch effects and scales or centers the data. To remove batch effects, it uses the
remove_batch_effects(), that utilizes limma package. For scaling, it uses the scale()
from base R."><meta property="og:description" content="normalize_data() normalizes the data by scaling them and removing their batch effects.
It first converts the data to wide format if they are not already. It then removes
the batch effects and scales or centers the data. To remove batch effects, it uses the
remove_batch_effects(), that utilizes limma package. For scaling, it uses the scale()
from base R."><meta property="og:image" content="https://hda1472.github.io/DA_RPackage/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HDAnalyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Normalize data and remove batch effects</h1>

      <div class="d-none name"><code>normalize_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>normalize_data()</code> normalizes the data by scaling them and removing their batch effects.
It first converts the data to wide format if they are not already. It then removes
the batch effects and scales or centers the data. To remove batch effects, it uses the
<code><a href="remove_batch_effects.html">remove_batch_effects()</a></code>, that utilizes limma package. For scaling, it uses the <code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale()</a></code>
from base R.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">normalize_data</span><span class="op">(</span></span>
<span>  <span class="va">olink_data</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wide <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  batch2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_long <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  file_name <span class="op">=</span> <span class="st">"normalized_data"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-olink-data">olink_data<a class="anchor" aria-label="anchor" href="#arg-olink-data"></a></dt>
<dd><p>A dataset containing Olink data to be normalized.</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>A dataset containing the metadata information.</p></dd>


<dt id="arg-wide">wide<a class="anchor" aria-label="anchor" href="#arg-wide"></a></dt>
<dd><p>A logical value indicating whether the data is in wide format. Default is TRUE.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>A logical value indicating whether to center the data. Default is TRUE.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>A logical value indicating whether to scale the data. Default is TRUE.</p></dd>


<dt id="arg-batch">batch<a class="anchor" aria-label="anchor" href="#arg-batch"></a></dt>
<dd><p>The metadata column containing the batch information. In order to correct for batch effects, this parameter should be provided. Default is NULL.</p></dd>


<dt id="arg-batch-">batch2<a class="anchor" aria-label="anchor" href="#arg-batch-"></a></dt>
<dd><p>The metadata column containing the second batch information. Default is NULL.</p></dd>


<dt id="arg-return-long">return_long<a class="anchor" aria-label="anchor" href="#arg-return-long"></a></dt>
<dd><p>A logical value indicating whether to return the data in long format. Default is FALSE.</p></dd>


<dt id="arg-save">save<a class="anchor" aria-label="anchor" href="#arg-save"></a></dt>
<dd><p>A logical value indicating whether to save the data. Default is FALSE.</p></dd>


<dt id="arg-file-name">file_name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>The name of the file to be saved. Default is "normalized_data".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing the normalized data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Non-normalized data</span></span></span>
<span class="r-in"><span><span class="va">example_data</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">DAid</span>, <span class="va">Assay</span>, <span class="va">NPX</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"Assay"</span>, values_from <span class="op">=</span> <span class="st">"NPX"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 586 × 101</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    DAid    AARSD1   ABL1  ACAA1    ACAN    ACE2  ACOX1   ACP5    ACP6  ACTA2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> DA00001   3.39  2.76   1.71   0.033<span style="text-decoration: underline;">3</span>  1.76   -<span style="color: #BB0000;">0.919</span> 1.54    2.15    2.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> DA00002   1.42  1.25  -<span style="color: #BB0000;">0.816</span> -<span style="color: #BB0000;">0.459</span>   0.826  -<span style="color: #BB0000;">0.902</span> 0.647   1.30    0.798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> DA00003  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      0.989  <span style="color: #BB0000;">NA</span>       0.330 1.37   <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> DA00004   3.41  3.38   1.69  <span style="color: #BB0000;">NA</span>       1.52   <span style="color: #BB0000;">NA</span>     0.841   0.582   1.70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> DA00005   5.01  5.05   0.128  0.401  -<span style="color: #BB0000;">0.933</span>  -<span style="color: #BB0000;">0.584</span> 0.026<span style="text-decoration: underline;">5</span>  1.16    2.73 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> DA00006   6.83  1.18  -<span style="color: #BB0000;">1.74</span>  -<span style="color: #BB0000;">0.156</span>   1.53   -<span style="color: #BB0000;">0.721</span> 0.620   0.527   0.772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> DA00007  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      3.96   0.682   3.14    2.62  1.47    2.25    2.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> DA00008   2.78  0.812 -<span style="color: #BB0000;">0.552</span>  0.982  -<span style="color: #BB0000;">0.101</span>  -<span style="color: #BB0000;">0.304</span> 0.376  -<span style="color: #BB0000;">0.826</span>   1.52 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> DA00009   4.39  3.34  -<span style="color: #BB0000;">0.452</span> -<span style="color: #BB0000;">0.868</span>   0.395   1.71  1.49   -<span style="color: #BB0000;">0.028</span><span style="color: #BB0000; text-decoration: underline;">5</span>  0.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> DA00010   1.83  1.21  -<span style="color: #BB0000;">0.912</span> -<span style="color: #BB0000;">1.04</span>   -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.304</span> 1.69    0.092<span style="text-decoration: underline;">0</span>  2.04 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 576 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 91 more variables: ACTN4 &lt;dbl&gt;, ACY1 &lt;dbl&gt;, ADA &lt;dbl&gt;, ADA2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAM15 &lt;dbl&gt;, ADAM23 &lt;dbl&gt;, ADAM8 &lt;dbl&gt;, ADAMTS13 &lt;dbl&gt;, ADAMTS15 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAMTS16 &lt;dbl&gt;, ADAMTS8 &lt;dbl&gt;, ADCYAP1R1 &lt;dbl&gt;, ADGRE2 &lt;dbl&gt;, ADGRE5 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADGRG1 &lt;dbl&gt;, ADGRG2 &lt;dbl&gt;, ADH4 &lt;dbl&gt;, ADM &lt;dbl&gt;, AGER &lt;dbl&gt;, AGR2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AGR3 &lt;dbl&gt;, AGRN &lt;dbl&gt;, AGRP &lt;dbl&gt;, AGXT &lt;dbl&gt;, AHCY &lt;dbl&gt;, AHSP &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AIF1 &lt;dbl&gt;, AIFM1 &lt;dbl&gt;, AK1 &lt;dbl&gt;, AKR1B1 &lt;dbl&gt;, AKR1C4 &lt;dbl&gt;, …</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Center data</span></span></span>
<span class="r-in"><span><span class="fu">normalize_data</span><span class="op">(</span><span class="va">example_data</span>, <span class="va">example_metadata</span>, wide <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 586 × 101</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    DAid    AARSD1   ABL1  ACAA1   ACAN   ACE2  ACOX1    ACP5    ACP6   ACTA2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> DA00001  0.259  0.949  0.697 -<span style="color: #BB0000;">0.532</span>  0.827 -<span style="color: #BB0000;">1.42</span>   0.612   1.02    1.20  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> DA00002 -<span style="color: #BB0000;">1.71</span>  -<span style="color: #BB0000;">0.563</span> -<span style="color: #BB0000;">1.83</span>  -<span style="color: #BB0000;">1.02</span>  -<span style="color: #BB0000;">0.102</span> -<span style="color: #BB0000;">1.40</span>  -<span style="color: #BB0000;">0.278</span>   0.168  -<span style="color: #BB0000;">0.813</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> DA00003 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      0.424 <span style="color: #BB0000;">NA</span>     -<span style="color: #BB0000;">0.167</span>  0.447  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> DA00004  0.278  1.57   0.683 <span style="color: #BB0000;">NA</span>      0.593 <span style="color: #BB0000;">NA</span>     -<span style="color: #BB0000;">0.083</span><span style="color: #BB0000; text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.551</span>   0.089<span style="text-decoration: underline;">2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> DA00005  1.88   3.24  -<span style="color: #BB0000;">0.882</span> -<span style="color: #BB0000;">0.165</span> -<span style="color: #BB0000;">1.86</span>  -<span style="color: #BB0000;">1.08</span>  -<span style="color: #BB0000;">0.898</span>   0.023<span style="text-decoration: underline;">6</span>  1.12  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> DA00006  3.70  -<span style="color: #BB0000;">0.628</span> -<span style="color: #BB0000;">2.75</span>  -<span style="color: #BB0000;">0.721</span>  0.600 -<span style="color: #BB0000;">1.22</span>  -<span style="color: #BB0000;">0.305</span>  -<span style="color: #BB0000;">0.606</span>  -<span style="color: #BB0000;">0.840</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> DA00007 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      2.95   0.117  2.21   2.12   0.548   1.12    0.398 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> DA00008 -<span style="color: #BB0000;">0.351</span> -<span style="color: #BB0000;">0.998</span> -<span style="color: #BB0000;">1.56</span>   0.416 -<span style="color: #BB0000;">1.03</span>  -<span style="color: #BB0000;">0.800</span> -<span style="color: #BB0000;">0.549</span>  -<span style="color: #BB0000;">1.96</span>   -<span style="color: #BB0000;">0.090</span><span style="color: #BB0000; text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> DA00009  1.26   1.53  -<span style="color: #BB0000;">1.46</span>  -<span style="color: #BB0000;">1.43</span>  -<span style="color: #BB0000;">0.533</span>  1.21   0.562  -<span style="color: #BB0000;">1.16</span>   -<span style="color: #BB0000;">1.41</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> DA00010 -<span style="color: #BB0000;">1.30</span>  -<span style="color: #BB0000;">0.596</span> -<span style="color: #BB0000;">1.92</span>  -<span style="color: #BB0000;">1.60</span>  -<span style="color: #BB0000;">1.02</span>  -<span style="color: #BB0000;">0.801</span>  0.765  -<span style="color: #BB0000;">1.04</span>    0.427 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 576 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 91 more variables: ACTN4 &lt;dbl&gt;, ACY1 &lt;dbl&gt;, ADA &lt;dbl&gt;, ADA2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAM15 &lt;dbl&gt;, ADAM23 &lt;dbl&gt;, ADAM8 &lt;dbl&gt;, ADAMTS13 &lt;dbl&gt;, ADAMTS15 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAMTS16 &lt;dbl&gt;, ADAMTS8 &lt;dbl&gt;, ADCYAP1R1 &lt;dbl&gt;, ADGRE2 &lt;dbl&gt;, ADGRE5 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADGRG1 &lt;dbl&gt;, ADGRG2 &lt;dbl&gt;, ADH4 &lt;dbl&gt;, ADM &lt;dbl&gt;, AGER &lt;dbl&gt;, AGR2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AGR3 &lt;dbl&gt;, AGRN &lt;dbl&gt;, AGRP &lt;dbl&gt;, AGXT &lt;dbl&gt;, AHCY &lt;dbl&gt;, AHSP &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AIF1 &lt;dbl&gt;, AIFM1 &lt;dbl&gt;, AK1 &lt;dbl&gt;, AKR1B1 &lt;dbl&gt;, AKR1C4 &lt;dbl&gt;, …</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Center and scale data (z-score scaling)</span></span></span>
<span class="r-in"><span><span class="fu">normalize_data</span><span class="op">(</span><span class="va">example_data</span>, <span class="va">example_metadata</span>, wide <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 586 × 101</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    DAid    AARSD1   ABL1  ACAA1   ACAN    ACE2  ACOX1   ACP5    ACP6   ACTA2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> DA00001  0.240  0.685  0.498 -<span style="color: #BB0000;">0.753</span>  0.722  -<span style="color: #BB0000;">1.39</span>   0.800  0.991   1.16  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> DA00002 -<span style="color: #BB0000;">1.58</span>  -<span style="color: #BB0000;">0.406</span> -<span style="color: #BB0000;">1.30</span>  -<span style="color: #BB0000;">1.45</span>  -<span style="color: #BB0000;">0.088</span><span style="color: #BB0000; text-decoration: underline;">5</span> -<span style="color: #BB0000;">1.37</span>  -<span style="color: #BB0000;">0.364</span>  0.163  -<span style="color: #BB0000;">0.786</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> DA00003 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      0.600 <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">0.163</span>  0.584 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> DA00004  0.257  1.14   0.488 <span style="color: #BB0000;">NA</span>      0.517  <span style="color: #BB0000;">NA</span>     -<span style="color: #BB0000;">0.110</span> -<span style="color: #BB0000;">0.536</span>   0.086<span style="text-decoration: underline;">2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> DA00005  1.74   2.34  -<span style="color: #BB0000;">0.629</span> -<span style="color: #BB0000;">0.233</span> -<span style="color: #BB0000;">1.62</span>   -<span style="color: #BB0000;">1.06</span>  -<span style="color: #BB0000;">1.18</span>   0.023<span style="text-decoration: underline;">0</span>  1.08  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> DA00006  3.42  -<span style="color: #BB0000;">0.453</span> -<span style="color: #BB0000;">1.96</span>  -<span style="color: #BB0000;">1.02</span>   0.523  -<span style="color: #BB0000;">1.19</span>  -<span style="color: #BB0000;">0.399</span> -<span style="color: #BB0000;">0.590</span>  -<span style="color: #BB0000;">0.812</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> DA00007 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      2.11   0.165  1.93    2.08   0.717  1.09    0.385 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> DA00008 -<span style="color: #BB0000;">0.325</span> -<span style="color: #BB0000;">0.721</span> -<span style="color: #BB0000;">1.12</span>   0.589 -<span style="color: #BB0000;">0.898</span>  -<span style="color: #BB0000;">0.783</span> -<span style="color: #BB0000;">0.719</span> -<span style="color: #BB0000;">1.90</span>   -<span style="color: #BB0000;">0.087</span><span style="color: #BB0000; text-decoration: underline;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> DA00009  1.17   1.11  -<span style="color: #BB0000;">1.04</span>  -<span style="color: #BB0000;">2.03</span>  -<span style="color: #BB0000;">0.464</span>   1.18   0.735 -<span style="color: #BB0000;">1.13</span>   -<span style="color: #BB0000;">1.36</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> DA00010 -<span style="color: #BB0000;">1.20</span>  -<span style="color: #BB0000;">0.431</span> -<span style="color: #BB0000;">1.37</span>  -<span style="color: #BB0000;">2.27</span>  -<span style="color: #BB0000;">0.889</span>  -<span style="color: #BB0000;">0.784</span>  1.00  -<span style="color: #BB0000;">1.01</span>    0.413 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 576 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 91 more variables: ACTN4 &lt;dbl&gt;, ACY1 &lt;dbl&gt;, ADA &lt;dbl&gt;, ADA2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAM15 &lt;dbl&gt;, ADAM23 &lt;dbl&gt;, ADAM8 &lt;dbl&gt;, ADAMTS13 &lt;dbl&gt;, ADAMTS15 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAMTS16 &lt;dbl&gt;, ADAMTS8 &lt;dbl&gt;, ADCYAP1R1 &lt;dbl&gt;, ADGRE2 &lt;dbl&gt;, ADGRE5 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADGRG1 &lt;dbl&gt;, ADGRG2 &lt;dbl&gt;, ADH4 &lt;dbl&gt;, ADM &lt;dbl&gt;, AGER &lt;dbl&gt;, AGR2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AGR3 &lt;dbl&gt;, AGRN &lt;dbl&gt;, AGRP &lt;dbl&gt;, AGXT &lt;dbl&gt;, AHCY &lt;dbl&gt;, AHSP &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AIF1 &lt;dbl&gt;, AIFM1 &lt;dbl&gt;, AK1 &lt;dbl&gt;, AKR1B1 &lt;dbl&gt;, AKR1C4 &lt;dbl&gt;, …</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Center, scale and remove batch effects</span></span></span>
<span class="r-in"><span><span class="fu">normalize_data</span><span class="op">(</span><span class="va">example_data</span>, <span class="va">example_metadata</span>, wide <span class="op">=</span> <span class="cn">FALSE</span>, batch <span class="op">=</span> <span class="st">"Cohort"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 586 × 101</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    DAid   AARSD1   ABL1  ACAA1   ACAN   ACE2  ACOX1   ACP5    ACP6  ACTA2  ACTN4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> DA000…  0.104  0.476  0.391 -<span style="color: #BB0000;">0.779</span>  0.544 -<span style="color: #BB0000;">1.46</span>   0.701  0.915   0.985  0.516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> DA000… -<span style="color: #BB0000;">1.74</span>  -<span style="color: #BB0000;">0.656</span> -<span style="color: #BB0000;">1.43</span>  -<span style="color: #BB0000;">1.48</span>  -<span style="color: #BB0000;">0.286</span> -<span style="color: #BB0000;">1.44</span>  -<span style="color: #BB0000;">0.471</span>  0.083<span style="text-decoration: underline;">8</span> -<span style="color: #BB0000;">1.02</span>  -<span style="color: #BB0000;">0.761</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> DA000… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      0.574 <span style="color: #BB0000;">NA</span>     -<span style="color: #BB0000;">0.232</span>  0.484 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> DA000…  0.121  0.944  0.380 <span style="color: #BB0000;">NA</span>      0.335 <span style="color: #BB0000;">NA</span>     -<span style="color: #BB0000;">0.215</span> -<span style="color: #BB0000;">0.618</span>  -<span style="color: #BB0000;">0.122</span> -<span style="color: #BB0000;">0.486</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> DA000…  1.62   2.20  -<span style="color: #BB0000;">0.746</span> -<span style="color: #BB0000;">0.259</span> -<span style="color: #BB0000;">1.86</span>  -<span style="color: #BB0000;">1.13</span>  -<span style="color: #BB0000;">1.29</span>  -<span style="color: #BB0000;">0.056</span><span style="color: #BB0000; text-decoration: underline;">9</span>  0.903 -<span style="color: #BB0000;">0.103</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> DA000…  3.32  -<span style="color: #BB0000;">0.705</span> -<span style="color: #BB0000;">2.09</span>  -<span style="color: #BB0000;">1.05</span>   0.341 -<span style="color: #BB0000;">1.26</span>  -<span style="color: #BB0000;">0.507</span> -<span style="color: #BB0000;">0.672</span>  -<span style="color: #BB0000;">1.05</span>  <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> DA000… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      2.02   0.140  1.78   2.01   0.618  1.01    0.186 -<span style="color: #BB0000;">0.388</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> DA000… -<span style="color: #BB0000;">0.468</span> -<span style="color: #BB0000;">0.983</span> -<span style="color: #BB0000;">1.24</span>   0.563 -<span style="color: #BB0000;">1.12</span>  -<span style="color: #BB0000;">0.854</span> -<span style="color: #BB0000;">0.828</span> -<span style="color: #BB0000;">1.99</span>   -<span style="color: #BB0000;">0.300</span> -<span style="color: #BB0000;">1.60</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> DA000…  1.04   0.915 -<span style="color: #BB0000;">1.16</span>  -<span style="color: #BB0000;">2.05</span>  -<span style="color: #BB0000;">0.671</span>  1.12   0.636 -<span style="color: #BB0000;">1.21</span>   -<span style="color: #BB0000;">1.61</span>  -<span style="color: #BB0000;">1.50</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> DA000… -<span style="color: #BB0000;">1.36</span>  -<span style="color: #BB0000;">0.681</span> -<span style="color: #BB0000;">1.49</span>  -<span style="color: #BB0000;">2.30</span>  -<span style="color: #BB0000;">1.11</span>  -<span style="color: #BB0000;">0.855</span>  0.903 -<span style="color: #BB0000;">1.10</span>    0.214  0.136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 576 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 90 more variables: ACY1 &lt;dbl&gt;, ADA &lt;dbl&gt;, ADA2 &lt;dbl&gt;, ADAM15 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAM23 &lt;dbl&gt;, ADAM8 &lt;dbl&gt;, ADAMTS13 &lt;dbl&gt;, ADAMTS15 &lt;dbl&gt;, ADAMTS16 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADAMTS8 &lt;dbl&gt;, ADCYAP1R1 &lt;dbl&gt;, ADGRE2 &lt;dbl&gt;, ADGRE5 &lt;dbl&gt;, ADGRG1 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ADGRG2 &lt;dbl&gt;, ADH4 &lt;dbl&gt;, ADM &lt;dbl&gt;, AGER &lt;dbl&gt;, AGR2 &lt;dbl&gt;, AGR3 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AGRN &lt;dbl&gt;, AGRP &lt;dbl&gt;, AGXT &lt;dbl&gt;, AHCY &lt;dbl&gt;, AHSP &lt;dbl&gt;, AIF1 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   AIFM1 &lt;dbl&gt;, AK1 &lt;dbl&gt;, AKR1B1 &lt;dbl&gt;, AKR1C4 &lt;dbl&gt;, AKT1S1 &lt;dbl&gt;, …</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

